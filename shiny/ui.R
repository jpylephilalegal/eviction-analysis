library(shiny)
library(leaflet)
library(acs)

true_false_any <- c("True", "False", "Any")

zip_codes <- c("Any", "19019", "19092", "19093", "19099", "19101", "19102", "19103", "19104", "19105", "19106", "19107", "19108", "19109", "19110", "19111", "19112", "19113", "19114", "19115", "19116", "19118", "19119", "19120", "19121", "19122", "19123", "19124", "19125", "19126", "19127", "19128", "19129", "19130", "19131", "19132", "19133", "19134", "19135", "19136", "19137", "19138", "19139", "19140", "19141", "19142", "19143", "19144", "19145", "19146", "19147", "19148", "19149", "19150", "19151", "19152", "19153", "19154", "19155", "19160", "19161", "19162", "19170", "19171", "19172", "19173", "19175", "19176", "19177", "19178", "19179", "19181", "19182", "19183", "19184", "19185", "19187", "19188", "19190", "19191", "19192", "19193", "19194", "19195", "19196", "19197", "19244", "19255")

census_tracts <- c("Any" = "Any",
                   "Census Tract 1" = "42101000100",
                   "Census Tract 2" = "42101000200",
                   "Census Tract 3" = "42101000300",
                   "Census Tract 4.01" = "42101000401",
                   "Census Tract 4.02" = "42101000402",
                   "Census Tract 5" = "42101000500",
                   "Census Tract 6" = "42101000600",
                   "Census Tract 7" = "42101000700",
                   "Census Tract 8.01" = "42101000801",
                   "Census Tract 8.03" = "42101000803",
                   "Census Tract 8.04" = "42101000804",
                   "Census Tract 9.01" = "42101000901",
                   "Census Tract 9.02" = "42101000902",
                   "Census Tract 10.01" = "42101001001",
                   "Census Tract 10.02" = "42101001002",
                   "Census Tract 11.01" = "42101001101",
                   "Census Tract 11.02" = "42101001102",
                   "Census Tract 12.01" = "42101001201",
                   "Census Tract 12.02" = "42101001202",
                   "Census Tract 13" = "42101001300",
                   "Census Tract 14" = "42101001400",
                   "Census Tract 15" = "42101001500",
                   "Census Tract 16" = "42101001600",
                   "Census Tract 17" = "42101001700",
                   "Census Tract 18" = "42101001800",
                   "Census Tract 19" = "42101001900",
                   "Census Tract 20" = "42101002000",
                   "Census Tract 21" = "42101002100",
                   "Census Tract 22" = "42101002200",
                   "Census Tract 23" = "42101002300",
                   "Census Tract 24" = "42101002400",
                   "Census Tract 25" = "42101002500",
                   "Census Tract 27.01" = "42101002701",
                   "Census Tract 27.02" = "42101002702",
                   "Census Tract 28.01" = "42101002801",
                   "Census Tract 28.02" = "42101002802",
                   "Census Tract 29" = "42101002900",
                   "Census Tract 30.01" = "42101003001",
                   "Census Tract 30.02" = "42101003002",
                   "Census Tract 31" = "42101003100",
                   "Census Tract 32" = "42101003200",
                   "Census Tract 33" = "42101003300",
                   "Census Tract 36" = "42101003600",
                   "Census Tract 37.01" = "42101003701",
                   "Census Tract 37.02" = "42101003702",
                   "Census Tract 38" = "42101003800",
                   "Census Tract 39.01" = "42101003901",
                   "Census Tract 39.02" = "42101003902",
                   "Census Tract 40.01" = "42101004001",
                   "Census Tract 40.02" = "42101004002",
                   "Census Tract 41.01" = "42101004101",
                   "Census Tract 41.02" = "42101004102",
                   "Census Tract 42.01" = "42101004201",
                   "Census Tract 42.02" = "42101004202",
                   "Census Tract 50" = "42101005000",
                   "Census Tract 54" = "42101005400",
                   "Census Tract 55" = "42101005500",
                   "Census Tract 56" = "42101005600",
                   "Census Tract 60" = "42101006000",
                   "Census Tract 61" = "42101006100",
                   "Census Tract 62" = "42101006200",
                   "Census Tract 63" = "42101006300",
                   "Census Tract 64" = "42101006400",
                   "Census Tract 65" = "42101006500",
                   "Census Tract 66" = "42101006600",
                   "Census Tract 67" = "42101006700",
                   "Census Tract 69" = "42101006900",
                   "Census Tract 70" = "42101007000",
                   "Census Tract 71.01" = "42101007101",
                   "Census Tract 71.02" = "42101007102",
                   "Census Tract 72" = "42101007200",
                   "Census Tract 73" = "42101007300",
                   "Census Tract 74" = "42101007400",
                   "Census Tract 77" = "42101007700",
                   "Census Tract 78" = "42101007800",
                   "Census Tract 79" = "42101007900",
                   "Census Tract 80" = "42101008000",
                   "Census Tract 81.01" = "42101008101",
                   "Census Tract 81.02" = "42101008102",
                   "Census Tract 82" = "42101008200",
                   "Census Tract 83.01" = "42101008301",
                   "Census Tract 83.02" = "42101008302",
                   "Census Tract 84" = "42101008400",
                   "Census Tract 85" = "42101008500",
                   "Census Tract 86.01" = "42101008601",
                   "Census Tract 86.02" = "42101008602",
                   "Census Tract 87.01" = "42101008701",
                   "Census Tract 87.02" = "42101008702",
                   "Census Tract 88.01" = "42101008801",
                   "Census Tract 88.02" = "42101008802",
                   "Census Tract 90" = "42101009000",
                   "Census Tract 91" = "42101009100",
                   "Census Tract 92" = "42101009200",
                   "Census Tract 93" = "42101009300",
                   "Census Tract 94" = "42101009400",
                   "Census Tract 95" = "42101009500",
                   "Census Tract 96" = "42101009600",
                   "Census Tract 98.01" = "42101009801",
                   "Census Tract 98.02" = "42101009802",
                   "Census Tract 100" = "42101010000",
                   "Census Tract 101" = "42101010100",
                   "Census Tract 102" = "42101010200",
                   "Census Tract 103" = "42101010300",
                   "Census Tract 104" = "42101010400",
                   "Census Tract 105" = "42101010500",
                   "Census Tract 106" = "42101010600",
                   "Census Tract 107" = "42101010700",
                   "Census Tract 108" = "42101010800",
                   "Census Tract 109" = "42101010900",
                   "Census Tract 110" = "42101011000",
                   "Census Tract 111" = "42101011100",
                   "Census Tract 112" = "42101011200",
                   "Census Tract 113" = "42101011300",
                   "Census Tract 114" = "42101011400",
                   "Census Tract 115" = "42101011500",
                   "Census Tract 117" = "42101011700",
                   "Census Tract 118" = "42101011800",
                   "Census Tract 119" = "42101011900",
                   "Census Tract 120" = "42101012000",
                   "Census Tract 121" = "42101012100",
                   "Census Tract 122.01" = "42101012201",
                   "Census Tract 122.03" = "42101012203",
                   "Census Tract 122.04" = "42101012204",
                   "Census Tract 125" = "42101012500",
                   "Census Tract 131" = "42101013100",
                   "Census Tract 132" = "42101013200",
                   "Census Tract 133" = "42101013300",
                   "Census Tract 134.01" = "42101013401",
                   "Census Tract 134.02" = "42101013402",
                   "Census Tract 135" = "42101013500",
                   "Census Tract 136.01" = "42101013601",
                   "Census Tract 136.02" = "42101013602",
                   "Census Tract 137" = "42101013700",
                   "Census Tract 138" = "42101013800",
                   "Census Tract 139" = "42101013900",
                   "Census Tract 140" = "42101014000",
                   "Census Tract 141" = "42101014100",
                   "Census Tract 142" = "42101014200",
                   "Census Tract 143" = "42101014300",
                   "Census Tract 144" = "42101014400",
                   "Census Tract 145" = "42101014500",
                   "Census Tract 146" = "42101014600",
                   "Census Tract 147" = "42101014700",
                   "Census Tract 148" = "42101014800",
                   "Census Tract 149" = "42101014900",
                   "Census Tract 151.01" = "42101015101",
                   "Census Tract 151.02" = "42101015102",
                   "Census Tract 152" = "42101015200",
                   "Census Tract 153" = "42101015300",
                   "Census Tract 156" = "42101015600",
                   "Census Tract 157" = "42101015700",
                   "Census Tract 158" = "42101015800",
                   "Census Tract 160" = "42101016000",
                   "Census Tract 161" = "42101016100",
                   "Census Tract 162" = "42101016200",
                   "Census Tract 163" = "42101016300",
                   "Census Tract 164" = "42101016400",
                   "Census Tract 165" = "42101016500",
                   "Census Tract 166" = "42101016600",
                   "Census Tract 167.01" = "42101016701",
                   "Census Tract 167.02" = "42101016702",
                   "Census Tract 168" = "42101016800",
                   "Census Tract 169.01" = "42101016901",
                   "Census Tract 169.02" = "42101016902",
                   "Census Tract 170" = "42101017000",
                   "Census Tract 171" = "42101017100",
                   "Census Tract 172.01" = "42101017201",
                   "Census Tract 172.02" = "42101017202",
                   "Census Tract 173" = "42101017300",
                   "Census Tract 174" = "42101017400",
                   "Census Tract 175" = "42101017500",
                   "Census Tract 176.01" = "42101017601",
                   "Census Tract 176.02" = "42101017602",
                   "Census Tract 177.01" = "42101017701",
                   "Census Tract 177.02" = "42101017702",
                   "Census Tract 178" = "42101017800",
                   "Census Tract 179" = "42101017900",
                   "Census Tract 180.01" = "42101018001",
                   "Census Tract 180.02" = "42101018002",
                   "Census Tract 183" = "42101018300",
                   "Census Tract 184" = "42101018400",
                   "Census Tract 188" = "42101018800",
                   "Census Tract 190" = "42101019000",
                   "Census Tract 191" = "42101019100",
                   "Census Tract 192" = "42101019200",
                   "Census Tract 195.01" = "42101019501",
                   "Census Tract 195.02" = "42101019502",
                   "Census Tract 197" = "42101019700",
                   "Census Tract 198" = "42101019800",
                   "Census Tract 199" = "42101019900",
                   "Census Tract 200" = "42101020000",
                   "Census Tract 201.01" = "42101020101",
                   "Census Tract 201.02" = "42101020102",
                   "Census Tract 202" = "42101020200",
                   "Census Tract 203" = "42101020300",
                   "Census Tract 204" = "42101020400",
                   "Census Tract 205" = "42101020500",
                   "Census Tract 206" = "42101020600",
                   "Census Tract 207" = "42101020700",
                   "Census Tract 208" = "42101020800",
                   "Census Tract 209" = "42101020900",
                   "Census Tract 210" = "42101021000",
                   "Census Tract 211" = "42101021100",
                   "Census Tract 212" = "42101021200",
                   "Census Tract 213" = "42101021300",
                   "Census Tract 214" = "42101021400",
                   "Census Tract 215" = "42101021500",
                   "Census Tract 216" = "42101021600",
                   "Census Tract 217" = "42101021700",
                   "Census Tract 218" = "42101021800",
                   "Census Tract 219" = "42101021900",
                   "Census Tract 220" = "42101022000",
                   "Census Tract 231" = "42101023100",
                   "Census Tract 235" = "42101023500",
                   "Census Tract 236" = "42101023600",
                   "Census Tract 237" = "42101023700",
                   "Census Tract 238" = "42101023800",
                   "Census Tract 239" = "42101023900",
                   "Census Tract 240" = "42101024000",
                   "Census Tract 241" = "42101024100",
                   "Census Tract 242" = "42101024200",
                   "Census Tract 243" = "42101024300",
                   "Census Tract 244" = "42101024400",
                   "Census Tract 245" = "42101024500",
                   "Census Tract 246" = "42101024600",
                   "Census Tract 247" = "42101024700",
                   "Census Tract 248" = "42101024800",
                   "Census Tract 249" = "42101024900",
                   "Census Tract 252" = "42101025200",
                   "Census Tract 253" = "42101025300",
                   "Census Tract 254" = "42101025400",
                   "Census Tract 255" = "42101025500",
                   "Census Tract 256" = "42101025600",
                   "Census Tract 257" = "42101025700",
                   "Census Tract 258" = "42101025800",
                   "Census Tract 259" = "42101025900",
                   "Census Tract 260" = "42101026000",
                   "Census Tract 261" = "42101026100",
                   "Census Tract 262" = "42101026200",
                   "Census Tract 263.01" = "42101026301",
                   "Census Tract 263.02" = "42101026302",
                   "Census Tract 264" = "42101026400",
                   "Census Tract 265" = "42101026500",
                   "Census Tract 266" = "42101026600",
                   "Census Tract 267" = "42101026700",
                   "Census Tract 268" = "42101026800",
                   "Census Tract 269" = "42101026900",
                   "Census Tract 270" = "42101027000",
                   "Census Tract 271" = "42101027100",
                   "Census Tract 272" = "42101027200",
                   "Census Tract 273" = "42101027300",
                   "Census Tract 274.01" = "42101027401",
                   "Census Tract 274.02" = "42101027402",
                   "Census Tract 275" = "42101027500",
                   "Census Tract 276" = "42101027600",
                   "Census Tract 277" = "42101027700",
                   "Census Tract 278" = "42101027800",
                   "Census Tract 279.01" = "42101027901",
                   "Census Tract 279.02" = "42101027902",
                   "Census Tract 280" = "42101028000",
                   "Census Tract 281" = "42101028100",
                   "Census Tract 282" = "42101028200",
                   "Census Tract 283" = "42101028300",
                   "Census Tract 284" = "42101028400",
                   "Census Tract 285" = "42101028500",
                   "Census Tract 286" = "42101028600",
                   "Census Tract 287" = "42101028700",
                   "Census Tract 288" = "42101028800",
                   "Census Tract 289.01" = "42101028901",
                   "Census Tract 289.02" = "42101028902",
                   "Census Tract 290" = "42101029000",
                   "Census Tract 291" = "42101029100",
                   "Census Tract 292" = "42101029200",
                   "Census Tract 293" = "42101029300",
                   "Census Tract 294" = "42101029400",
                   "Census Tract 298" = "42101029800",
                   "Census Tract 299" = "42101029900",
                   "Census Tract 300" = "42101030000",
                   "Census Tract 301" = "42101030100",
                   "Census Tract 302" = "42101030200",
                   "Census Tract 305.01" = "42101030501",
                   "Census Tract 305.02" = "42101030502",
                   "Census Tract 306" = "42101030600",
                   "Census Tract 307" = "42101030700",
                   "Census Tract 308" = "42101030800",
                   "Census Tract 309" = "42101030900",
                   "Census Tract 310" = "42101031000",
                   "Census Tract 311.01" = "42101031101",
                   "Census Tract 311.02" = "42101031102",
                   "Census Tract 312" = "42101031200",
                   "Census Tract 313" = "42101031300",
                   "Census Tract 314.01" = "42101031401",
                   "Census Tract 314.02" = "42101031402",
                   "Census Tract 315.01" = "42101031501",
                   "Census Tract 315.02" = "42101031502",
                   "Census Tract 316" = "42101031600",
                   "Census Tract 317" = "42101031700",
                   "Census Tract 318" = "42101031800",
                   "Census Tract 319" = "42101031900",
                   "Census Tract 320" = "42101032000",
                   "Census Tract 321" = "42101032100",
                   "Census Tract 323" = "42101032300",
                   "Census Tract 325" = "42101032500",
                   "Census Tract 326" = "42101032600",
                   "Census Tract 329" = "42101032900",
                   "Census Tract 330" = "42101033000",
                   "Census Tract 331.01" = "42101033101",
                   "Census Tract 331.02" = "42101033102",
                   "Census Tract 332" = "42101033200",
                   "Census Tract 333" = "42101033300",
                   "Census Tract 334" = "42101033400",
                   "Census Tract 335" = "42101033500",
                   "Census Tract 336" = "42101033600",
                   "Census Tract 337.01" = "42101033701",
                   "Census Tract 337.02" = "42101033702",
                   "Census Tract 338" = "42101033800",
                   "Census Tract 339" = "42101033900",
                   "Census Tract 340" = "42101034000",
                   "Census Tract 341" = "42101034100",
                   "Census Tract 342" = "42101034200",
                   "Census Tract 344" = "42101034400",
                   "Census Tract 345.01" = "42101034501",
                   "Census Tract 345.02" = "42101034502",
                   "Census Tract 346" = "42101034600",
                   "Census Tract 347.01" = "42101034701",
                   "Census Tract 347.02" = "42101034702",
                   "Census Tract 348.01" = "42101034801",
                   "Census Tract 348.02" = "42101034802",
                   "Census Tract 348.03" = "42101034803",
                   "Census Tract 349" = "42101034900",
                   "Census Tract 351" = "42101035100",
                   "Census Tract 352" = "42101035200",
                   "Census Tract 353.01" = "42101035301",
                   "Census Tract 353.02" = "42101035302",
                   "Census Tract 355" = "42101035500",
                   "Census Tract 356.01" = "42101035601",
                   "Census Tract 356.02" = "42101035602",
                   "Census Tract 357.01" = "42101035701",
                   "Census Tract 357.02" = "42101035702",
                   "Census Tract 358" = "42101035800",
                   "Census Tract 359" = "42101035900",
                   "Census Tract 360" = "42101036000",
                   "Census Tract 361" = "42101036100",
                   "Census Tract 362.01" = "42101036201",
                   "Census Tract 362.02" = "42101036202",
                   "Census Tract 362.03" = "42101036203",
                   "Census Tract 363.01" = "42101036301",
                   "Census Tract 363.02" = "42101036302",
                   "Census Tract 363.03" = "42101036303",
                   "Census Tract 364" = "42101036400",
                   "Census Tract 365.01" = "42101036501",
                   "Census Tract 365.02" = "42101036502",
                   "Census Tract 366" = "42101036600",
                   "Census Tract 367" = "42101036700",
                   "Census Tract 369" = "42101036900",
                   "Census Tract 372" = "42101037200",
                   "Census Tract 373" = "42101037300",
                   "Census Tract 375" = "42101037500",
                   "Census Tract 376" = "42101037600",
                   "Census Tract 377" = "42101037700",
                   "Census Tract 378" = "42101037800",
                   "Census Tract 379" = "42101037900",
                   "Census Tract 380" = "42101038000",
                   "Census Tract 381" = "42101038100",
                   "Census Tract 382" = "42101038200",
                   "Census Tract 383" = "42101038300",
                   "Census Tract 384" = "42101038400",
                   "Census Tract 385" = "42101038500",
                   "Census Tract 386" = "42101038600",
                   "Census Tract 387" = "42101038700",
                   "Census Tract 388" = "42101038800",
                   "Census Tract 389" = "42101038900",
                   "Census Tract 390" = "42101039000",
                   "Census Tract 9800" = "42101980000",
                   "Census Tract 9801" = "42101980100",
                   "Census Tract 9802" = "42101980200",
                   "Census Tract 9803" = "42101980300",
                   "Census Tract 9804" = "42101980400",
                   "Census Tract 9805" = "42101980500",
                   "Census Tract 9806" = "42101980600",
                   "Census Tract 9807" = "42101980700",
                   "Census Tract 9808" = "42101980800",
                   "Census Tract 9809" = "42101980900",
                   "Census Tract 9891" = "42101989100")

#pa.counties <- c("All Counties", na.omit(geo.lookup(state=c("PA"), county=c("County"))[, "county.name"]))

shinyUI(fluidPage(
    tags$head(
             tags$link(rel = "stylesheet", type = "text/css", href = "sankey.css")
         ),
    titlePanel(NULL, windowTitle="Eviction"),
    sidebarLayout(
        sidebarPanel(
            selectInput("metric", "Metric:", c("Rented vs. owned", "Rented vs. owned change", "Ratio of licenses to units", "Ratio of licenses to units change", "Rental unit trends", "Lawsuit rate", "Lawsuit rate change", "Lawsuit trends", "Eviction process")),
            selectInput("area", "Area:", c("Philadelphia", "Pennsylvania")),
            conditionalPanel(
                condition = "input.metric == 'Lawsuit trends' && input.area == 'Philadelphia'",
                selectInput("statistic", "Show:", c("Number of cases", "Percentage of cases", "Median ongoing rent", "Median amount sought", "Median rent sought", "Average months of rent sought", "Median months of rent sought", "Median judgment amount")),
                radioButtons("t_a", "Non-payment alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_b", "Termination of term alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_c", "Other breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_possession_sought", "Possession sought", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_money_judgment_sought", "Money judgment sought", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_publichousing", "PHA plaintiff", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_defendant_represented", "Defendant represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_plaintiff_represented", "Plaintiff represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_withdrawn", "Withdrawn", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_default_judgment", "Default judgment entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_petition_to_open", "Petition to open filed", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_jba", "Judgment by agreement entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_jba_breach", "JBA breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_court_order", "Court order", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_judgment_for_defendant", "Judgment for defendant", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_judgment_for_plaintiff", "Judgment for plaintiff", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_satisfied", "Judgment satisfied", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_writ_of_possession", "Writ of possession entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_alias_writ", "Alias writ of possession entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_alias_writ_served", "Alias writ of possession served", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_appeal", "Appeal filed", true_false_any, selected="Any", inline=TRUE),
                selectInput("zip", "Zip code:", zip_codes),
                selectInput("census", "Census tract:", census_tracts),
                sliderInput("rent", "Ongoing rent:",
                            min = 0, max = 2000, sep = '',
                            value = c(0, 2000)),
                sliderInput("years", "Years:",
                            min = 2008, max = 2017, sep = '',
                            value = c(2008, 2017))
            ),
            conditionalPanel(
                condition = "input.metric == 'Lawsuit rate' || input.metric == 'Rented vs. owned' || input.metric == 'Ratio of licenses to units'",
                sliderInput("year", "Year:",
                            min = 2010, max = 2016, sep = '',
                            value = 2016)
            ),
            conditionalPanel(
                condition = "input.metric == 'Rental unit trends'",
                selectInput("dtstatistic", "Show:", c("Number of renter-occupied units", "Rental percentage", "Ratio of licenses to units")),
                selectInput("dtzip", "Zip code:", zip_codes),
                selectInput("dtcensus", "Census tract:", census_tracts)
            ),
            conditionalPanel(
                condition = "input.metric == 'Rented vs. owned change' || input.metric == 'Lawsuit rate change' || input.metric == 'Rental unit trends' || input.metric == 'Ratio of licenses to units change'",
                sliderInput("changeyears", "Years:",
                            min = 2010, max = 2016, sep = '',
                            value = c(2010, 2016))
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process'",
                radioButtons("a", "Non-payment alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("b", "Termination of term alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("c", "Other breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("publichousing", "PHA plaintiff", true_false_any, selected="Any", inline=TRUE),
                radioButtons("defendant_represented", "Defendant represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("plaintiff_represented", "Plaintiff represented", true_false_any, selected="Any", inline=TRUE),
                selectInput("epzip", "Zip code:", zip_codes),
                selectInput("epcensus", "Census tract:", census_tracts),
                sliderInput("yearrange", "Years:",
                            min = 2008, max = 2017, sep = '',
                            value = c(2017, 2017))
            ),
            img(src='pla.png', width="60%", align="center")
        ),
        mainPanel(
            conditionalPanel(
                condition = "input.metric != 'Eviction process' && input.metric != 'Lawsuit trends' && input.metric != 'Rental unit trends'",
                leafletOutput("mymap", width="100%", height="95vh")
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process'",
                htmlOutput("frame")
            ),
            conditionalPanel(
                condition = "input.metric == 'Lawsuit trends' || input.metric == 'Rental unit trends'",
                plotOutput("plot")
            )
        )
    )
))
