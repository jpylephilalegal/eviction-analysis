library(shiny)
library(shinycssloaders)
library(leaflet)
library(acs)

true_false_any <- c("True", "False", "Any")

pa_counties <- c("Any", "Adams", "Allegheny", "Armstrong", "Beaver", "Bedford", "Berks", "Blair", "Bradford", "Bucks", "Butler", "Cambria", "Cameron", "Carbon", "Centre", "Chester", "Clarion", "Clearfield", "Clinton", "Columbia", "Crawford", "Cumberland", "Dauphin", "Delaware", "Elk", "Erie", "Fayette", "Forest", "Franklin", "Fulton", "Greene", "Huntingdon", "Indiana", "Jefferson", "Juniata", "Lackawanna", "Lancaster", "Lawrence", "Lebanon", "Lehigh", "Luzerne", "Lycoming", "McKean", "Mercer", "Mifflin", "Monroe", "Montgomery", "Montour", "Northampton", "Northumberland", "Perry", "Pike", "Potter", "Schuylkill", "Snyder", "Somerset", "Sullivan", "Susquehanna", "Tioga", "Union", "Venango", "Warren", "Washington", "Wayne", "Westmoreland", "Wyoming", "York")

zip_codes <- c("Any", "19019", "19092", "19093", "19099", "19101", "19102", "19103", "19104", "19105", "19106", "19107", "19108", "19109", "19110", "19111", "19112", "19113", "19114", "19115", "19116", "19118", "19119", "19120", "19121", "19122", "19123", "19124", "19125", "19126", "19127", "19128", "19129", "19130", "19131", "19132", "19133", "19134", "19135", "19136", "19137", "19138", "19139", "19140", "19141", "19142", "19143", "19144", "19145", "19146", "19147", "19148", "19149", "19150", "19151", "19152", "19153", "19154", "19155", "19160", "19161", "19162", "19170", "19171", "19172", "19173", "19175", "19176", "19177", "19178", "19179", "19181", "19182", "19183", "19184", "19185", "19187", "19188", "19190", "19191", "19192", "19193", "19194", "19195", "19196", "19197", "19244", "19255")

pa_zip_codes <- c("Any", "15001", "15003", "15004", "15005", "15006", "15007", "15009", "15010", "15012", "15014", "15015", "15017", "15018", "15019", "15020", "15021", "15022", "15024", "15025", "15026", "15027", "15028", "15030", "15031", "15032", "15047", "15091", "15095", "15096", "15123", "15127", "15130", "15134", "15189", "15230", "15231", "15240", "15242", "15244", "15250", "15251", "15252", "15253", "15254", "15255", "15257", "15258", "15259", "15260", "15261", "15262", "15263", "15264", "15265", "15266", "15267", "15268", "15270", "15272", "15274", "15276", "15277", "15278", "15279", "15281", "15282", "15283", "15285", "15286", "15290", "15033", "15034", "15035", "15036", "15037", "15038", "15042", "15043", "15044", "15045", "15046", "15049", "15050", "15051", "15052", "15053", "15054", "15055", "15056", "15057", "15059", "15060", "15061", "15062", "15063", "15064", "15065", "15066", "15067", "15068", "15069", "15605", "15606", "15616", "15619", "15621", "15071", "15072", "15074", "15075", "15076", "15077", "15078", "15081", "15082", "15083", "15084", "15085", "15086", "15087", "15088", "15089", "15090", "15101", "15102", "15104", "15106", "15108", "15110", "15112", "15116", "15120", "15122", "15126", "15129", "15131", "15132", "15133", "15135", "15136", "15137", "15139", "15140", "15142", "15143", "15144", "15145", "15146", "15147", "15148", "15163", "15201", "15202", "15203", "15204", "15205", "15206", "15207", "15208", "15209", "15210", "15211", "15212", "15213", "15214", "15215", "15216", "15217", "15218", "15219", "15220", "15221", "15222", "15223", "15224", "15225", "15226", "15227", "15228", "15229", "15232", "15233", "15234", "15235", "15236", "15237", "15238", "15239", "15241", "15243", "15246", "15273", "15275", "15288", "15289", "15295", "15298", "15301", "15310", "15311", "15312", "15313", "15314", "15315", "15316", "15317", "15320", "15321", "15322", "15323", "15324", "15325", "15327", "15329", "15330", "15331", "15332", "15333", "15334", "15336", "15337", "15338", "15339", "15340", "15341", "15342", "15344", "15345", "15346", "15347", "15348", "15349", "15350", "15351", "15352", "15353", "15354", "15355", "15357", "15358", "15359", "15360", "15361", "15362", "15363", "15364", "15365", "15366", "15367", "15368", "15370", "15376", "15377", "15378", "15379", "15380", "15401", "15410", "15411", "15412", "15413", "15415", "15416", "15465", "15467", "15417", "15419", "15420", "15421", "15422", "15423", "15424", "15425", "15427", "15428", "15429", "15430", "15431", "15432", "15433", "15434", "15435", "15436", "15437", "15438", "15439", "15440", "15442", "15443", "15444", "15445", "15446", "15447", "15448", "15449", "15450", "15451", "15454", "15455", "15456", "15458", "15459", "15460", "15461", "15462", "15463", "15464", "15466", "15468", "15469", "15470", "15471", "15472", "15473", "15474", "15475", "15476", "15477", "15478", "15479", "15480", "15482", "15483", "15484", "15485", "15486", "15488", "15489", "15490", "15492", "15493", "15501", "15502", "15510", "15520", "15521", "15522", "15530", "15531", "15532", "15533", "15534", "15535", "15536", "15537", "15538", "15539", "15540", "15541", "15542", "15544", "15545", "15546", "15547", "15548", "15549", "15550", "15551", "15552", "15553", "15554", "15555", "15557", "15558", "15559", "15560", "15561", "15562", "15563", "15564", "15565", "15601", "15610", "15611", "15612", "15613", "15615", "15617", "15618", "15620", "15622", "15623", "15624", "15625", "15626", "15627", "15628", "15629", "15630", "15682", "16215", "16216", "16261", "15631", "15632", "15633", "15634", "15635", "15636", "15637", "15638", "15639", "15640", "15641", "15642", "15643", "15644", "15646", "15647", "15650", "15655", "15656", "15658", "15660", "15661", "15662", "15663", "15664", "15665", "15666", "15668", "15670", "15671", "15672", "15673", "15674", "15675", "15676", "15677", "15678", "15679", "15680", "15681", "15683", "15684", "15685", "15686", "15687", "15688", "15689", "15690", "15691", "15692", "15693", "15695", "15696", "15697", "15698", "15701", "15705", "15751", "15758", "16211", "15710", "15711", "15712", "15713", "15714", "15715", "15716", "15717", "15720", "15721", "15722", "15723", "15724", "15725", "15727", "15728", "15729", "15730", "15731", "15732", "15733", "15734", "15736", "15737", "15738", "15739", "15740", "15741", "15742", "15744", "15745", "15746", "15747", "15748", "15750", "15752", "15753", "15754", "15756", "15757", "15759", "15760", "15761", "15762", "15763", "15764", "15765", "15767", "15770", "15771", "15772", "15773", "15774", "15775", "15776", "15777", "15778", "15779", "15780", "15781", "15783", "15784", "15801", "15817", "15821", "15822", "16728", "15823", "15824", "15825", "15827", "15828", "15829", "15831", "15832", "15834", "15840", "15841", "15845", "15846", "15847", "15848", "15849", "15851", "15853", "15856", "15857", "15860", "15861", "15863", "15864", "15865", "15866", "15868", "15870", "15874", "15901", "15902", "15904", "15905", "15906", "15907", "15909", "15915", "15922", "16699", "15920", "15921", "15923", "15924", "15925", "15926", "15927", "15928", "15929", "15930", "15931", "15934", "15935", "15936", "15937", "15938", "15940", "15942", "15943", "15944", "15945", "15946", "15948", "15949", "15951", "15952", "15953", "15954", "15955", "15956", "15957", "15958", "15959", "15960", "15961", "15962", "15963", "15965", "15973", "16001", "16002", "16003", "16016", "16017", "16018", "16021", "16039", "16006", "16020", "16022", "16023", "16024", "16025", "16027", "16028", "16029", "16030", "16033", "16034", "16035", "16036", "16037", "16038", "16040", "16041", "16045", "16046", "16048", "16049", "16050", "16051", "16052", "16053", "16054", "16055", "16056", "16057", "16058", "16220", "16221", "16225", "16257", "16375", "16059", "16061", "16063", "16066", "16101", "16102", "16103", "16107", "16108", "16105", "16110", "16111", "16112", "16113", "16114", "16115", "16116", "16117", "16120", "16121", "16123", "16124", "16125", "16127", "16130", "16131", "16132", "16133", "16134", "16136", "16137", "16140", "16141", "16142", "16143", "16145", "16146", "16148", "16150", "16151", "16153", "16154", "16155", "16156", "16157", "16159", "16160", "16161", "16172", "16201", "16210", "16212", "16213", "16214", "16217", "16218", "16222", "16223", "16224", "16226", "16228", "16229", "16230", "16232", "16233", "16234", "16235", "16236", "16238", "16239", "16240", "16242", "16244", "16245", "16246", "16248", "16249", "16250", "16253", "16254", "16255", "16256", "16258", "16259", "16260", "16262", "16263", "16299", "16301", "16302", "16311", "16312", "16313", "16314", "16316", "16317", "16319", "16321", "16322", "16323", "16326", "16327", "16328", "16432", "16329", "16331", "16332", "16333", "16334", "16335", "16340", "16341", "16342", "16343", "16344", "16345", "16346", "16347", "16350", "16351", "16352", "16353", "16354", "16355", "16360", "16361", "16362", "16364", "16365", "16366", "16367", "16368", "16369", "16370", "16371", "16372", "16373", "16374", "16388", "16401", "16402", "16403", "16404", "16405", "16406", "16407", "16410", "16411", "16412", "16413", "16444", "16475", "16514", "16515", "16522", "16530", "16531", "16532", "16533", "16534", "16538", "16541", "16544", "16546", "16550", "16553", "16554", "16558", "16563", "16565", "16414", "16415", "16416", "16417", "16420", "16421", "16422", "16423", "16424", "16426", "16427", "16428", "16430", "16433", "16434", "16435", "16436", "16438", "16440", "16441", "16442", "16443", "16501", "16502", "16503", "16504", "16505", "16506", "16507", "16508", "16509", "16510", "16511", "16512", "16601", "16602", "16603", "16611", "16613", "16614", "16616", "16617", "16619", "16620", "16621", "16622", "16623", "16624", "16625", "16627", "16629", "16630", "16631", "16633", "16634", "16635", "16636", "16637", "16638", "16639", "16640", "16641", "16644", "16645", "16646", "16647", "16648", "16650", "16651", "16652", "16654", "16660", "16655", "16656", "16657", "16659", "16661", "16662", "16663", "16664", "16665", "16666", "16667", "16668", "16669", "16670", "16671", "16672", "16673", "16674", "16675", "16677", "16678", "16679", "16680", "16681", "16682", "16683", "16684", "16685", "16686", "16689", "16691", "16692", "16693", "16694", "16695", "16698", "16821", "16850", "16873", "16701", "16720", "16724", "16725", "16726", "16727", "16729", "16730", "16731", "16732", "16733", "16734", "16735", "16738", "16740", "16743", "16744", "16745", "16746", "16748", "16749", "16750", "16751", "16801", "16802", "16803", "16804", "16805", "16815", "16820", "16822", "16823", "16825", "16826", "16827", "16828", "16829", "16830", "16832", "16833", "16834", "16835", "16836", "16837", "16838", "16839", "16840", "16841", "16843", "16844", "16845", "16847", "16848", "16849", "16851", "16852", "16853", "16854", "16855", "16856", "16858", "16859", "16860", "16861", "16863", "16864", "16865", "16866", "16868", "16870", "16871", "16872", "16874", "16875", "16876", "16877", "16878", "16879", "16881", "16882", "16901", "16910", "16945", "17735", "17743", "18815", "16911", "16912", "16914", "16915", "16917", "16918", "16920", "16921", "16922", "16923", "16925", "16926", "16927", "16928", "16929", "16930", "16932", "16933", "16935", "16936", "16937", "16938", "16939", "16940", "16941", "16942", "16943", "16946", "16947", "16948", "16950", "17001", "17002", "17003", "17004", "17005", "17006", "17007", "17008", "17009", "17010", "17011", "17012", "17091", "17013", "17014", "17056", "17015", "17016", "17017", "17018", "17019", "17020", "17021", "17022", "17023", "17024", "17025", "17026", "17027", "17028", "17029", "17030", "17031", "17071", "17032", "17033", "17034", "17035", "17036", "17037", "17038", "17039", "17040", "17041", "17042", "17043", "17044", "17045", "17046", "17047", "17048", "17049", "17050", "17051", "17052", "17053", "17054", "17055", "17057", "17058", "17059", "17060", "17061", "17062", "17063", "17064", "17065", "17066", "17067", "17068", "17069", "17070", "17072", "17073", "17074", "17075", "17076", "17077", "17078", "17080", "17081", "17082", "17083", "17084", "17085", "17086", "17087", "17088", "17089", "17090", "17093", "17094", "17097", "17098", "17099", "17101", "17102", "17103", "17104", "17105", "17106", "17107", "17108", "17109", "17110", "17111", "17112", "17113", "17120", "17121", "17122", "17123", "17124", "17125", "17126", "17127", "17129", "17128", "17130", "17140", "17177", "17201", "17202", "17210", "17211", "17212", "17213", "17214", "17215", "17217", "17219", "17220", "17221", "17222", "17223", "17224", "17225", "17228", "17229", "17231", "17232", "17233", "17235", "17236", "17237", "17238", "17239", "17240", "17241", "17243", "17244", "17246", "17247", "17249", "17250", "17251", "17252", "17253", "17254", "17255", "17256", "17257", "17260", "17261", "17262", "17263", "17264", "17265", "17266", "17267", "17268", "17269", "17270", "17271", "17272", "17275", "17294", "17301", "17302", "17303", "17304", "17306", "17307", "17309", "17310", "17311", "17312", "17313", "17314", "17315", "17316", "17317", "17318", "17319", "17320", "17321", "17322", "17323", "17324", "17325", "17326", "17375", "17327", "17329", "17331", "17332", "17333", "17358", "17415", "17334", "17335", "17337", "17339", "17340", "17342", "17343", "17344", "17345", "17346", "17347", "17349", "17350", "17352", "17353", "17354", "17355", "17356", "17360", "17361", "17362", "17363", "17364", "17365", "17366", "17368", "17370", "17371", "17372", "17401", "17402", "17403", "17404", "17405", "17406", "17407", "17408", "17501", "17502", "17503", "17564", "17573", "17577", "17605", "17607", "17608", "17699", "17504", "17505", "17506", "17507", "17508", "17509", "17511", "17512", "17516", "17517", "17518", "17519", "17520", "17521", "17522", "17527", "17528", "17529", "17532", "17533", "17534", "17535", "17536", "17537", "17538", "17540", "17543", "17545", "17547", "17549", "17550", "17551", "17552", "17554", "17555", "17557", "17560", "17562", "17563", "17565", "17566", "17567", "17568", "17569", "17570", "17572", "17575", "17576", "17578", "17579", "17580", "17581", "17582", "17583", "17584", "17585", "17601", "17602", "17603", "17604", "17606", "17611", "17622", "17701", "17702", "17703", "17705", "17722", "17723", "17727", "17769", "17720", "17721", "17724", "17726", "17728", "17729", "17730", "17731", "17737", "17738", "17739", "17740", "17741", "17742", "17744", "17745", "17747", "17748", "17749", "17750", "17751", "17752", "17754", "17756", "17757", "17758", "17759", "17760", "17762", "17763", "17764", "17765", "17767", "17768", "17771", "17772", "17773", "17774", "17776", "17777", "17778", "17779", "17786", "17801", "17810", "17812", "17813", "17814", "17815", "17820", "17821", "17822", "17823", "17824", "17825", "17827", "17828", "17829", "17830", "17831", "17832", "17833", "17834", "17835", "17836", "17837", "17839", "17840", "17841", "17842", "17843", "17844", "17845", "17846", "17847", "17850", "17851", "17853", "17855", "17856", "17857", "17858", "17859", "17860", "17861", "17862", "17864", "17865", "17866", "17867", "17868", "17870", "17872", "17876", "17877", "17878", "17880", "17883", "17881", "17882", "17884", "17885", "17886", "17887", "17888", "17889", "17901", "17920", "17921", "17922", "17923", "17925", "17927", "17929", "17930", "17931", "17932", "17933", "17934", "17935", "17936", "17938", "17941", "17942", "17966", "17943", "17944", "17945", "17946", "17948", "17949", "17951", "17952", "17953", "17954", "17957", "17959", "17960", "17961", "17963", "17964", "17965", "17967", "17968", "17970", "17972", "17974", "17976", "17978", "17979", "17980", "17981", "17982", "17983", "17985", "18001", "18003", "18010", "18016", "18025", "18044", "18050", "18068", "18098", "18099", "18105", "18109", "18002", "18011", "18012", "18013", "18014", "18015", "18017", "18018", "18020", "18021", "18024", "18030", "18031", "18032", "18034", "18035", "18036", "18037", "18038", "18039", "18910", "18911", "18916", "18921", "18922", "18931", "18933", "18935", "18953", "18963", "18968", "18981", "18991", "19049", "19058", "19059", "18040", "18041", "18042", "18043", "18045", "18046", "18049", "18051", "18052", "18053", "18054", "18055", "18056", "18058", "18059", "18060", "18062", "18063", "18064", "18065", "18066", "18067", "18069", "18070", "18071", "18072", "18073", "18074", "18076", "18077", "18078", "18079", "18080", "18081", "18083", "18084", "18085", "18086", "18087", "18088", "18091", "18092", "18096", "18101", "18102", "18103", "18104", "18106", "18160", "18175", "18195", "18201", "18202", "18210", "18211", "18212", "18214", "18216", "18218", "18219", "18220", "18221", "18222", "18223", "18690", "18710", "18711", "18761", "18762", "18763", "18764", "18765", "18767", "18768", "18769", "18773", "18774", "18224", "18225", "18229", "18230", "18231", "18232", "18234", "18235", "18237", "18239", "18240", "18241", "18242", "18243", "18244", "18245", "18246", "18247", "18248", "18249", "18250", "18251", "18252", "18254", "18255", "18256", "18301", "18302", "18320", "18321", "18322", "18323", "18324", "18325", "18326", "18327", "18328", "18330", "18331", "18332", "18333", "18334", "18335", "18336", "18337", "18340", "18341", "18342", "18343", "18344", "18346", "18347", "18348", "18349", "18350", "18351", "18352", "18353", "18354", "18355", "18356", "18357", "18360", "18370", "18371", "18373", "18372", "18377", "18401", "18449", "18454", "18403", "18405", "18407", "18410", "18411", "18413", "18414", "18415", "18416", "18417", "18419", "18420", "18421", "18424", "18425", "18426", "18427", "18428", "18430", "18431", "18433", "18434", "18435", "18436", "18437", "18438", "18439", "18440", "18441", "18443", "18444", "18445", "18446", "18447", "18448", "18451", "18452", "18453", "18455", "18456", "18457", "18458", "18459", "18460", "18461", "18462", "18463", "18464", "18465", "18466", "18469", "18470", "18471", "18472", "18473", "18501", "18514", "18522", "18540", "18577", "18502", "18503", "18504", "18505", "18507", "18508", "18509", "18510", "18512", "18515", "18517", "18518", "18519", "18601", "18602", "18603", "18610", "18611", "18612", "18614", "18615", "18616", "18617", "18618", "18619", "18621", "18622", "18623", "18624", "18625", "18626", "18627", "18628", "18629", "18630", "18631", "18632", "18634", "18635", "18636", "18638", "18640", "18641", "18642", "18643", "18644", "18651", "18653", "18654", "18655", "18656", "18657", "18660", "18661", "18672", "18701", "18702", "18703", "18704", "18705", "18706", "18707", "18708", "18709", "18715", "18766", "18801", "18810", "18812", "18813", "18814", "18816", "18817", "18818", "18820", "18821", "18822", "18823", "18824", "18825", "18826", "18827", "18828", "18829", "18830", "18831", "18832", "18833", "18834", "18837", "18839", "18840", "18842", "18843", "18844", "18845", "18846", "18847", "18848", "18850", "18851", "18853", "18854", "18901", "18902", "18903", "18912", "18913", "18914", "18915", "18917", "18918", "18920", "18923", "18924", "18925", "18926", "18927", "18928", "18929", "18930", "18932", "18934", "18936", "18938", "18940", "18942", "18943", "18944", "18945", "18946", "18947", "18949", "18950", "18951", "18954", "18955", "18956", "18957", "18958", "18960", "18962", "18964", "18966", "18969", "18970", "18971", "18972", "18974", "18976", "18977", "18979", "19404", "19407", "19409", "19424", "19429", "19441", "19450", "19451", "19452", "19455", "19483", "19484", "19485", "18980", "19001", "19002", "19003", "19004", "19006", "19007", "19008", "19009", "19010", "19012", "19013", "19014", "19015", "19016", "19028", "19037", "19088", "19091", "19339", "19340", "19017", "19018", "19020", "19021", "19022", "19023", "19025", "19026", "19027", "19029", "19030", "19031", "19032", "19033", "19034", "19035", "19036", "19038", "19039", "19040", "19041", "19043", "19044", "19046", "19047", "19048", "19050", "19052", "19053", "19054", "19055", "19056", "19057", "19060", "19061", "19063", "19064", "19065", "19066", "19067", "19070", "19072", "19073", "19074", "19075", "19076", "19078", "19079", "19080", "19081", "19082", "19083", "19085", "19086", "19087", "19089", "19090", "19094", "19095", "19096", "19098", "19156", "19301", "19310", "19311", "19312", "19316", "19317", "19318", "19319", "19320", "19330", "19331", "19333", "19335", "19341", "19342", "19343", "19344", "19345", "19346", "19347", "19351", "19357", "19366", "19370", "19371", "19376", "19381", "19397", "19398", "19399", "19487", "19488", "19489", "19493", "19494", "19495", "19496", "19348", "19350", "19352", "19353", "19354", "19355", "19358", "19360", "19362", "19363", "19365", "19367", "19369", "19372", "19373", "19374", "19375", "19380", "19382", "19383", "19388", "19390", "19395", "19401", "19403", "19405", "19406", "19408", "19415", "19420", "19421", "19422", "19423", "19425", "19426", "19428", "19430", "19432", "19435", "19436", "19437", "19438", "19440", "19442", "19443", "19444", "19446", "19453", "19454", "19456", "19457", "19460", "19462", "19464", "19465", "19468", "19470", "19472", "19473", "19474", "19475", "19477", "19478", "19480", "19481", "19482", "19486", "19490", "19492", "19501", "19503", "19504", "19505", "19506", "19507", "19508", "19510", "19511", "19512", "19516", "19517", "19548", "19640", "19518", "19519", "19520", "19522", "19523", "19524", "19525", "19526", "19529", "19530", "19533", "19534", "19535", "19536", "19538", "19539", "19540", "19541", "19542", "19543", "19544", "19545", "19546", "19547", "19549", "19550", "19551", "19554", "19555", "19557", "19559", "19560", "19562", "19564", "19565", "19567", "19601", "19602", "19603", "19604", "19605", "19606", "19607", "19608", "19609", "19610", "19611", "19612", "19650", "19685", "19743", "19815", "19853", "19925")

census_tracts <- c("Any" = "Any",
                   "Census Tract 1" = "42101000100",
                   "Census Tract 2" = "42101000200",
                   "Census Tract 3" = "42101000300",
                   "Census Tract 4.01" = "42101000401",
                   "Census Tract 4.02" = "42101000402",
                   "Census Tract 5" = "42101000500",
                   "Census Tract 6" = "42101000600",
                   "Census Tract 7" = "42101000700",
                   "Census Tract 8.01" = "42101000801",
                   "Census Tract 8.03" = "42101000803",
                   "Census Tract 8.04" = "42101000804",
                   "Census Tract 9.01" = "42101000901",
                   "Census Tract 9.02" = "42101000902",
                   "Census Tract 10.01" = "42101001001",
                   "Census Tract 10.02" = "42101001002",
                   "Census Tract 11.01" = "42101001101",
                   "Census Tract 11.02" = "42101001102",
                   "Census Tract 12.01" = "42101001201",
                   "Census Tract 12.02" = "42101001202",
                   "Census Tract 13" = "42101001300",
                   "Census Tract 14" = "42101001400",
                   "Census Tract 15" = "42101001500",
                   "Census Tract 16" = "42101001600",
                   "Census Tract 17" = "42101001700",
                   "Census Tract 18" = "42101001800",
                   "Census Tract 19" = "42101001900",
                   "Census Tract 20" = "42101002000",
                   "Census Tract 21" = "42101002100",
                   "Census Tract 22" = "42101002200",
                   "Census Tract 23" = "42101002300",
                   "Census Tract 24" = "42101002400",
                   "Census Tract 25" = "42101002500",
                   "Census Tract 27.01" = "42101002701",
                   "Census Tract 27.02" = "42101002702",
                   "Census Tract 28.01" = "42101002801",
                   "Census Tract 28.02" = "42101002802",
                   "Census Tract 29" = "42101002900",
                   "Census Tract 30.01" = "42101003001",
                   "Census Tract 30.02" = "42101003002",
                   "Census Tract 31" = "42101003100",
                   "Census Tract 32" = "42101003200",
                   "Census Tract 33" = "42101003300",
                   "Census Tract 36" = "42101003600",
                   "Census Tract 37.01" = "42101003701",
                   "Census Tract 37.02" = "42101003702",
                   "Census Tract 38" = "42101003800",
                   "Census Tract 39.01" = "42101003901",
                   "Census Tract 39.02" = "42101003902",
                   "Census Tract 40.01" = "42101004001",
                   "Census Tract 40.02" = "42101004002",
                   "Census Tract 41.01" = "42101004101",
                   "Census Tract 41.02" = "42101004102",
                   "Census Tract 42.01" = "42101004201",
                   "Census Tract 42.02" = "42101004202",
                   "Census Tract 50" = "42101005000",
                   "Census Tract 54" = "42101005400",
                   "Census Tract 55" = "42101005500",
                   "Census Tract 56" = "42101005600",
                   "Census Tract 60" = "42101006000",
                   "Census Tract 61" = "42101006100",
                   "Census Tract 62" = "42101006200",
                   "Census Tract 63" = "42101006300",
                   "Census Tract 64" = "42101006400",
                   "Census Tract 65" = "42101006500",
                   "Census Tract 66" = "42101006600",
                   "Census Tract 67" = "42101006700",
                   "Census Tract 69" = "42101006900",
                   "Census Tract 70" = "42101007000",
                   "Census Tract 71.01" = "42101007101",
                   "Census Tract 71.02" = "42101007102",
                   "Census Tract 72" = "42101007200",
                   "Census Tract 73" = "42101007300",
                   "Census Tract 74" = "42101007400",
                   "Census Tract 77" = "42101007700",
                   "Census Tract 78" = "42101007800",
                   "Census Tract 79" = "42101007900",
                   "Census Tract 80" = "42101008000",
                   "Census Tract 81.01" = "42101008101",
                   "Census Tract 81.02" = "42101008102",
                   "Census Tract 82" = "42101008200",
                   "Census Tract 83.01" = "42101008301",
                   "Census Tract 83.02" = "42101008302",
                   "Census Tract 84" = "42101008400",
                   "Census Tract 85" = "42101008500",
                   "Census Tract 86.01" = "42101008601",
                   "Census Tract 86.02" = "42101008602",
                   "Census Tract 87.01" = "42101008701",
                   "Census Tract 87.02" = "42101008702",
                   "Census Tract 88.01" = "42101008801",
                   "Census Tract 88.02" = "42101008802",
                   "Census Tract 90" = "42101009000",
                   "Census Tract 91" = "42101009100",
                   "Census Tract 92" = "42101009200",
                   "Census Tract 93" = "42101009300",
                   "Census Tract 94" = "42101009400",
                   "Census Tract 95" = "42101009500",
                   "Census Tract 96" = "42101009600",
                   "Census Tract 98.01" = "42101009801",
                   "Census Tract 98.02" = "42101009802",
                   "Census Tract 100" = "42101010000",
                   "Census Tract 101" = "42101010100",
                   "Census Tract 102" = "42101010200",
                   "Census Tract 103" = "42101010300",
                   "Census Tract 104" = "42101010400",
                   "Census Tract 105" = "42101010500",
                   "Census Tract 106" = "42101010600",
                   "Census Tract 107" = "42101010700",
                   "Census Tract 108" = "42101010800",
                   "Census Tract 109" = "42101010900",
                   "Census Tract 110" = "42101011000",
                   "Census Tract 111" = "42101011100",
                   "Census Tract 112" = "42101011200",
                   "Census Tract 113" = "42101011300",
                   "Census Tract 114" = "42101011400",
                   "Census Tract 115" = "42101011500",
                   "Census Tract 117" = "42101011700",
                   "Census Tract 118" = "42101011800",
                   "Census Tract 119" = "42101011900",
                   "Census Tract 120" = "42101012000",
                   "Census Tract 121" = "42101012100",
                   "Census Tract 122.01" = "42101012201",
                   "Census Tract 122.03" = "42101012203",
                   "Census Tract 122.04" = "42101012204",
                   "Census Tract 125" = "42101012500",
                   "Census Tract 131" = "42101013100",
                   "Census Tract 132" = "42101013200",
                   "Census Tract 133" = "42101013300",
                   "Census Tract 134.01" = "42101013401",
                   "Census Tract 134.02" = "42101013402",
                   "Census Tract 135" = "42101013500",
                   "Census Tract 136.01" = "42101013601",
                   "Census Tract 136.02" = "42101013602",
                   "Census Tract 137" = "42101013700",
                   "Census Tract 138" = "42101013800",
                   "Census Tract 139" = "42101013900",
                   "Census Tract 140" = "42101014000",
                   "Census Tract 141" = "42101014100",
                   "Census Tract 142" = "42101014200",
                   "Census Tract 143" = "42101014300",
                   "Census Tract 144" = "42101014400",
                   "Census Tract 145" = "42101014500",
                   "Census Tract 146" = "42101014600",
                   "Census Tract 147" = "42101014700",
                   "Census Tract 148" = "42101014800",
                   "Census Tract 149" = "42101014900",
                   "Census Tract 151.01" = "42101015101",
                   "Census Tract 151.02" = "42101015102",
                   "Census Tract 152" = "42101015200",
                   "Census Tract 153" = "42101015300",
                   "Census Tract 156" = "42101015600",
                   "Census Tract 157" = "42101015700",
                   "Census Tract 158" = "42101015800",
                   "Census Tract 160" = "42101016000",
                   "Census Tract 161" = "42101016100",
                   "Census Tract 162" = "42101016200",
                   "Census Tract 163" = "42101016300",
                   "Census Tract 164" = "42101016400",
                   "Census Tract 165" = "42101016500",
                   "Census Tract 166" = "42101016600",
                   "Census Tract 167.01" = "42101016701",
                   "Census Tract 167.02" = "42101016702",
                   "Census Tract 168" = "42101016800",
                   "Census Tract 169.01" = "42101016901",
                   "Census Tract 169.02" = "42101016902",
                   "Census Tract 170" = "42101017000",
                   "Census Tract 171" = "42101017100",
                   "Census Tract 172.01" = "42101017201",
                   "Census Tract 172.02" = "42101017202",
                   "Census Tract 173" = "42101017300",
                   "Census Tract 174" = "42101017400",
                   "Census Tract 175" = "42101017500",
                   "Census Tract 176.01" = "42101017601",
                   "Census Tract 176.02" = "42101017602",
                   "Census Tract 177.01" = "42101017701",
                   "Census Tract 177.02" = "42101017702",
                   "Census Tract 178" = "42101017800",
                   "Census Tract 179" = "42101017900",
                   "Census Tract 180.01" = "42101018001",
                   "Census Tract 180.02" = "42101018002",
                   "Census Tract 183" = "42101018300",
                   "Census Tract 184" = "42101018400",
                   "Census Tract 188" = "42101018800",
                   "Census Tract 190" = "42101019000",
                   "Census Tract 191" = "42101019100",
                   "Census Tract 192" = "42101019200",
                   "Census Tract 195.01" = "42101019501",
                   "Census Tract 195.02" = "42101019502",
                   "Census Tract 197" = "42101019700",
                   "Census Tract 198" = "42101019800",
                   "Census Tract 199" = "42101019900",
                   "Census Tract 200" = "42101020000",
                   "Census Tract 201.01" = "42101020101",
                   "Census Tract 201.02" = "42101020102",
                   "Census Tract 202" = "42101020200",
                   "Census Tract 203" = "42101020300",
                   "Census Tract 204" = "42101020400",
                   "Census Tract 205" = "42101020500",
                   "Census Tract 206" = "42101020600",
                   "Census Tract 207" = "42101020700",
                   "Census Tract 208" = "42101020800",
                   "Census Tract 209" = "42101020900",
                   "Census Tract 210" = "42101021000",
                   "Census Tract 211" = "42101021100",
                   "Census Tract 212" = "42101021200",
                   "Census Tract 213" = "42101021300",
                   "Census Tract 214" = "42101021400",
                   "Census Tract 215" = "42101021500",
                   "Census Tract 216" = "42101021600",
                   "Census Tract 217" = "42101021700",
                   "Census Tract 218" = "42101021800",
                   "Census Tract 219" = "42101021900",
                   "Census Tract 220" = "42101022000",
                   "Census Tract 231" = "42101023100",
                   "Census Tract 235" = "42101023500",
                   "Census Tract 236" = "42101023600",
                   "Census Tract 237" = "42101023700",
                   "Census Tract 238" = "42101023800",
                   "Census Tract 239" = "42101023900",
                   "Census Tract 240" = "42101024000",
                   "Census Tract 241" = "42101024100",
                   "Census Tract 242" = "42101024200",
                   "Census Tract 243" = "42101024300",
                   "Census Tract 244" = "42101024400",
                   "Census Tract 245" = "42101024500",
                   "Census Tract 246" = "42101024600",
                   "Census Tract 247" = "42101024700",
                   "Census Tract 248" = "42101024800",
                   "Census Tract 249" = "42101024900",
                   "Census Tract 252" = "42101025200",
                   "Census Tract 253" = "42101025300",
                   "Census Tract 254" = "42101025400",
                   "Census Tract 255" = "42101025500",
                   "Census Tract 256" = "42101025600",
                   "Census Tract 257" = "42101025700",
                   "Census Tract 258" = "42101025800",
                   "Census Tract 259" = "42101025900",
                   "Census Tract 260" = "42101026000",
                   "Census Tract 261" = "42101026100",
                   "Census Tract 262" = "42101026200",
                   "Census Tract 263.01" = "42101026301",
                   "Census Tract 263.02" = "42101026302",
                   "Census Tract 264" = "42101026400",
                   "Census Tract 265" = "42101026500",
                   "Census Tract 266" = "42101026600",
                   "Census Tract 267" = "42101026700",
                   "Census Tract 268" = "42101026800",
                   "Census Tract 269" = "42101026900",
                   "Census Tract 270" = "42101027000",
                   "Census Tract 271" = "42101027100",
                   "Census Tract 272" = "42101027200",
                   "Census Tract 273" = "42101027300",
                   "Census Tract 274.01" = "42101027401",
                   "Census Tract 274.02" = "42101027402",
                   "Census Tract 275" = "42101027500",
                   "Census Tract 276" = "42101027600",
                   "Census Tract 277" = "42101027700",
                   "Census Tract 278" = "42101027800",
                   "Census Tract 279.01" = "42101027901",
                   "Census Tract 279.02" = "42101027902",
                   "Census Tract 280" = "42101028000",
                   "Census Tract 281" = "42101028100",
                   "Census Tract 282" = "42101028200",
                   "Census Tract 283" = "42101028300",
                   "Census Tract 284" = "42101028400",
                   "Census Tract 285" = "42101028500",
                   "Census Tract 286" = "42101028600",
                   "Census Tract 287" = "42101028700",
                   "Census Tract 288" = "42101028800",
                   "Census Tract 289.01" = "42101028901",
                   "Census Tract 289.02" = "42101028902",
                   "Census Tract 290" = "42101029000",
                   "Census Tract 291" = "42101029100",
                   "Census Tract 292" = "42101029200",
                   "Census Tract 293" = "42101029300",
                   "Census Tract 294" = "42101029400",
                   "Census Tract 298" = "42101029800",
                   "Census Tract 299" = "42101029900",
                   "Census Tract 300" = "42101030000",
                   "Census Tract 301" = "42101030100",
                   "Census Tract 302" = "42101030200",
                   "Census Tract 305.01" = "42101030501",
                   "Census Tract 305.02" = "42101030502",
                   "Census Tract 306" = "42101030600",
                   "Census Tract 307" = "42101030700",
                   "Census Tract 308" = "42101030800",
                   "Census Tract 309" = "42101030900",
                   "Census Tract 310" = "42101031000",
                   "Census Tract 311.01" = "42101031101",
                   "Census Tract 311.02" = "42101031102",
                   "Census Tract 312" = "42101031200",
                   "Census Tract 313" = "42101031300",
                   "Census Tract 314.01" = "42101031401",
                   "Census Tract 314.02" = "42101031402",
                   "Census Tract 315.01" = "42101031501",
                   "Census Tract 315.02" = "42101031502",
                   "Census Tract 316" = "42101031600",
                   "Census Tract 317" = "42101031700",
                   "Census Tract 318" = "42101031800",
                   "Census Tract 319" = "42101031900",
                   "Census Tract 320" = "42101032000",
                   "Census Tract 321" = "42101032100",
                   "Census Tract 323" = "42101032300",
                   "Census Tract 325" = "42101032500",
                   "Census Tract 326" = "42101032600",
                   "Census Tract 329" = "42101032900",
                   "Census Tract 330" = "42101033000",
                   "Census Tract 331.01" = "42101033101",
                   "Census Tract 331.02" = "42101033102",
                   "Census Tract 332" = "42101033200",
                   "Census Tract 333" = "42101033300",
                   "Census Tract 334" = "42101033400",
                   "Census Tract 335" = "42101033500",
                   "Census Tract 336" = "42101033600",
                   "Census Tract 337.01" = "42101033701",
                   "Census Tract 337.02" = "42101033702",
                   "Census Tract 338" = "42101033800",
                   "Census Tract 339" = "42101033900",
                   "Census Tract 340" = "42101034000",
                   "Census Tract 341" = "42101034100",
                   "Census Tract 342" = "42101034200",
                   "Census Tract 344" = "42101034400",
                   "Census Tract 345.01" = "42101034501",
                   "Census Tract 345.02" = "42101034502",
                   "Census Tract 346" = "42101034600",
                   "Census Tract 347.01" = "42101034701",
                   "Census Tract 347.02" = "42101034702",
                   "Census Tract 348.01" = "42101034801",
                   "Census Tract 348.02" = "42101034802",
                   "Census Tract 348.03" = "42101034803",
                   "Census Tract 349" = "42101034900",
                   "Census Tract 351" = "42101035100",
                   "Census Tract 352" = "42101035200",
                   "Census Tract 353.01" = "42101035301",
                   "Census Tract 353.02" = "42101035302",
                   "Census Tract 355" = "42101035500",
                   "Census Tract 356.01" = "42101035601",
                   "Census Tract 356.02" = "42101035602",
                   "Census Tract 357.01" = "42101035701",
                   "Census Tract 357.02" = "42101035702",
                   "Census Tract 358" = "42101035800",
                   "Census Tract 359" = "42101035900",
                   "Census Tract 360" = "42101036000",
                   "Census Tract 361" = "42101036100",
                   "Census Tract 362.01" = "42101036201",
                   "Census Tract 362.02" = "42101036202",
                   "Census Tract 362.03" = "42101036203",
                   "Census Tract 363.01" = "42101036301",
                   "Census Tract 363.02" = "42101036302",
                   "Census Tract 363.03" = "42101036303",
                   "Census Tract 364" = "42101036400",
                   "Census Tract 365.01" = "42101036501",
                   "Census Tract 365.02" = "42101036502",
                   "Census Tract 366" = "42101036600",
                   "Census Tract 367" = "42101036700",
                   "Census Tract 369" = "42101036900",
                   "Census Tract 372" = "42101037200",
                   "Census Tract 373" = "42101037300",
                   "Census Tract 375" = "42101037500",
                   "Census Tract 376" = "42101037600",
                   "Census Tract 377" = "42101037700",
                   "Census Tract 378" = "42101037800",
                   "Census Tract 379" = "42101037900",
                   "Census Tract 380" = "42101038000",
                   "Census Tract 381" = "42101038100",
                   "Census Tract 382" = "42101038200",
                   "Census Tract 383" = "42101038300",
                   "Census Tract 384" = "42101038400",
                   "Census Tract 385" = "42101038500",
                   "Census Tract 386" = "42101038600",
                   "Census Tract 387" = "42101038700",
                   "Census Tract 388" = "42101038800",
                   "Census Tract 389" = "42101038900",
                   "Census Tract 390" = "42101039000",
                   "Census Tract 9800" = "42101980000",
                   "Census Tract 9801" = "42101980100",
                   "Census Tract 9802" = "42101980200",
                   "Census Tract 9803" = "42101980300",
                   "Census Tract 9804" = "42101980400",
                   "Census Tract 9805" = "42101980500",
                   "Census Tract 9806" = "42101980600",
                   "Census Tract 9807" = "42101980700",
                   "Census Tract 9808" = "42101980800",
                   "Census Tract 9809" = "42101980900",
                   "Census Tract 9891" = "42101989100")

shinyUI(fluidPage(
    tags$head(
             tags$link(rel = "stylesheet", type = "text/css", href = "sankey.css")
         ),
    titlePanel(NULL, windowTitle="Eviction"),
    sidebarLayout(
        sidebarPanel(
            selectInput("area", "Area:", c("Philadelphia", "Pennsylvania")),
            uiOutput('metric'),
            conditionalPanel(
                condition = "input.metric == 'Lawsuit trends' && input.area == 'Philadelphia'",
                selectInput("statistic", "Show:", c("Number of cases", "Percentage of cases", "Median ongoing rent", "Median amount sought", "Median rent sought", "Average months of rent sought", "Median months of rent sought", "Median judgment amount")),
                radioButtons("t_a", "Non-payment alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_b", "Termination of term alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_c", "Other breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_possession_sought", "Possession sought", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_money_judgment_sought", "Money judgment sought", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_publichousing", "PHA plaintiff", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_defendant_represented", "Defendant represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_plaintiff_represented", "Plaintiff represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_withdrawn", "Withdrawn", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_default_judgment", "Default judgment entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_petition_to_open", "Petition to open filed", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_jba", "Judgment by agreement entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_jba_breach", "JBA breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_court_order", "Court order", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_judgment_for_defendant", "Judgment for defendant", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_judgment_for_plaintiff", "Judgment for plaintiff", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_satisfied", "Judgment satisfied", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_writ_of_possession", "Writ of possession entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_alias_writ", "Alias writ of possession entered", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_alias_writ_served", "Alias writ of possession served", true_false_any, selected="Any", inline=TRUE),
                radioButtons("t_appeal", "Appeal filed", true_false_any, selected="Any", inline=TRUE),
                selectInput("zip", "Zip code:", zip_codes),
                selectInput("census", "Census tract:", census_tracts),
                sliderInput("rent", "$ Monthly Rent:",
                            min = 0, max = 2000, sep = '',
                            value = c(0, 2000)),
                sliderInput("years", "Years:",
                            min = 2008, max = 2018, sep = '',
                            value = c(2008, 2018))
            ),
            conditionalPanel(
                condition = "(input.metric == 'Lawsuit rate' || input.metric == 'Rented vs. owned' || input.metric == 'Ratio of licenses to units') && input.area == 'Philadelphia'",
                sliderInput("year", "Year:",
                            min = 2010, max = 2017, sep = '',
                            value = 2017)
            ),
            conditionalPanel(
                condition = "(input.metric == 'Lawsuit rate' || input.metric == 'Rented vs. owned' || input.metric == 'Ratio of licenses to units') && input.area == 'Pennsylvania'",
                sliderInput("stateyear", "Year:",
                            min = 2010, max = 2016, sep = '',
                            value = 2016)
            ),
            conditionalPanel(
                condition = "input.metric == 'Rental unit trends'",
                selectInput("dtstatistic", "Show:", c("Number of renter-occupied units", "Rental percentage", "Ratio of licenses to units")),
                selectInput("dtzip", "Zip code:", zip_codes),
                selectInput("dtcensus", "Census tract:", census_tracts)
            ),
            conditionalPanel(
                condition = "(input.metric == 'Rented vs. owned change' || input.metric == 'Lawsuit rate change' || input.metric == 'Rental unit trends' || input.metric == 'Ratio of licenses to units change') && input.area =='Philadelphia'",
                sliderInput("changeyears", "Years:",
                            min = 2010, max = 2017, sep = '',
                            value = c(2010, 2017))
            ),
            conditionalPanel(
                condition = "(input.metric == 'Rented vs. owned change' || input.metric == 'Lawsuit rate change' || input.metric == 'Rental unit trends' || input.metric == 'Ratio of licenses to units change') && input.area =='Pennsylvania'",
                sliderInput("pachangeyears", "Years:",
                            min = 2010, max = 2016, sep = '',
                            value = c(2010, 2016))
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process' && input.area == 'Philadelphia'",
                radioButtons("a", "Non-payment alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("b", "Termination of term alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("c", "Other breach alleged", true_false_any, selected="Any", inline=TRUE),
                radioButtons("publichousing", "PHA plaintiff", true_false_any, selected="Any", inline=TRUE)
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process'",
                radioButtons("defendant_represented", "Defendant represented", true_false_any, selected="Any", inline=TRUE),
                radioButtons("plaintiff_represented", "Plaintiff represented", true_false_any, selected="Any", inline=TRUE),
                sliderInput("rentrange", "$ Monthly Rent:",
                            min = 0, max = 2000, sep = '',
                            value = c(0, 2000))
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process' && input.area == 'Philadelphia'",
                selectInput("epzip", "Zip code:", zip_codes),
                selectInput("epcensus", "Census tract:", census_tracts),
                sliderInput("yearrange", "Years:",
                            min = 2008, max = 2019, sep = '',
                            value = c(2018, 2018))
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process' && input.area == 'Pennsylvania'",
                selectInput("county", "County:", pa_counties),
                selectInput("stateepzip", "Zip code:", pa_zip_codes),
                sliderInput("stateyearrange", "Years:",
                            min = 2010, max = 2016, sep = '',
                            value = c(2016, 2016))
            ),
            textOutput("caption"),
            img(src='pla.png', width="60%", align="center")
        ),
        mainPanel(
            conditionalPanel(
                condition = "input.metric != 'Eviction process' && input.metric != 'Lawsuit trends' && input.metric != 'Rental unit trends'",
                withSpinner(leafletOutput("mymap", width="100%", height="95vh"))
            ),
            conditionalPanel(
                condition = "input.metric == 'Eviction process'",
                htmlOutput("frame")
            ),
            conditionalPanel(
                condition = "input.metric == 'Lawsuit trends' || input.metric == 'Rental unit trends'",
                withSpinner(plotOutput("plot"))
            )
        )
    )
))
